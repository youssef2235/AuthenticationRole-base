@model Lab
@{
    ViewData["Title"] = "Details";
}

@section Styles {
    <link rel="stylesheet" href="~/css/LabResult.css" />
}

<body>
    <div class="container">
        <header>
            <h1>معمل التحاليل الزراعية المتقدمة</h1>
            <p>تقرير نتائج تحليل التربة والمياه</p>
        </header>

        <div class="report-info">
            <div>
                <div class="info-item"><strong>رقم العينة:</strong>@Model.Id</div>
                <div class="info-item"><strong>تاريخ الاستلام:</strong>@Model.ReceivedDate</div>
                <div class="info-item"><strong>تاريخ التقرير:</strong>@Model.ReportDate</div>
            </div>
            <div>
                <div class="info-item"><strong>اسم العميل:</strong>@Model.ClientName</div>
                <div class="info-item"><strong>الموقع:</strong>@Model.Location</div>
                <div class="info-item"><strong>نوع العينة:</strong>@Model.SampleType</div>
            </div>
        </div>

        <h2>نتائج تحليل التربة:</h2>
        <table>
            <thead>
                <tr>
                    <th>الخاصية</th>
                    <th>النتيجة</th>
                    <th>الوحدة</th>
                    <th>النطاق المرجعي</th>
                    <th>التقييم</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>درجة الحموضة (pH)</td>
                    <td>@Model.pH</td>
                    <td>-</td>
                    <td>6.5 - 7.5</td>
                    <td class="status-normal">طبيعي</td>
                </tr>
                <tr>
                    <td>الملوحة (EC)</td>
                    <td>@Model.ElectricalConductivity</td>
                    <td>dS/m</td>
                    <td>0 - 2.0</td>
                    <td class="status-warning">مرتفع</td>
                </tr>
                <tr>
                    <td>المادة العضوية</td>
                    <td>@Model.OrganicMatter</td>
                    <td>%</td>
                    <td>2.0 - 5.0</td>
                    <td class="status-danger">منخفض</td>
                </tr>
                <tr>
                    <td>النيتروجين الكلي (N)</td>
                    <td>@Model.TotalNitrogen</td>
                    <td>%</td>
                    <td>0.15 - 0.25</td>
                    <td class="status-danger">منخفض</td>
                </tr>
                <tr>
                    <td>الفوسفور المتاح (P)</td>
                    <td>@Model.AvailablePhosphorus</td>
                    <td>ppm</td>
                    <td>10 - 20</td>
                    <td class="status-normal">طبيعي</td>
                </tr>
                <tr>
                    <td>البوتاسيوم المتبادل (K)</td>
                    <td>@Model.ExchangePotassium</td>
                    <td>ppm</td>
                    <td>150 - 250</td>
                    <td class="status-normal">طبيعي</td>
                </tr>
                <tr>
                    <td>الكالسيوم (Ca)</td>
                    <td>@Model.Calcium</td>
                    <td>ppm</td>
                    <td>1000 - 2500</td>
                    <td class="status-normal">طبيعي</td>
                </tr>
                <tr>
                    <td>المغنيسيوم (Mg)</td>
                    <td>@Model.Magnesium</td>
                    <td>ppm</td>
                    <td>100 - 400</td>
                    <td class="status-normal">طبيعي</td>
                </tr>
                <tr>
                    <td>الحديد (Fe)</td>
                    <td>@Model.Iron</td>
                    <td>ppm</td>
                    <td>4.0 - 12.0</td>
                    <td class="status-warning">منخفض</td>
                </tr>
                <tr>
                    <td>الزنك (Zn)</td>
                    <td>@Model.Zinc</td>
                    <td>ppm</td>
                    <td>1.0 - 3.0</td>
                    <td class="status-danger">منخفض</td>
                </tr>
            </tbody>
        </table>

        <h2>تحليل النسيج والخصائص الفيزيائية:</h2>
        <table>
            <thead>
                <tr>
                    <th>الخاصية</th>
                    <th>النتيجة</th>
                    <th>الوحدة</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>الرمل</td>
                    <td>@Model.SandPercentage</td>
                    <td>%</td>
                </tr>
                <tr>
                    <td>الطمي</td>
                    <td>@Model.ClayPercentage</td>
                    <td>%</td>
                </tr>
                <tr>
                    <td>الطين</td>
                    <td>@Model.SiltPercentage</td>
                    <td>%</td>
                </tr>
                <tr>
                    <td>نوع التربة</td>
                    <td colspan="2">@Model.ClayPercentage</td>
                </tr>
                <tr>
                    <td>السعة الحقلية</td>
                    <td>@Model.ApparentDensity</td>
                    <td>%</td>
                </tr>
                <tr>
                    <td>الكثافة الظاهرية</td>
                    <td>@Model.SampleType</td>
                    <td>g/cm³</td>
                </tr>
            </tbody>
        </table>

        <div class="result-summary">

            <h3 style="padding-bottom:15px">ملخص النتائج والتوصيات:</h3>
            <p>بناءً على نتائج التحليل، تم تسجيل المشاكل التالية في التربة:</p>
            <ul style="padding-right:50px;padding-top:20px;">
                @if (!string.IsNullOrWhiteSpace(Model.Problems))
                {
                    foreach (var line in Model.Problems.Split("\n", StringSplitOptions.RemoveEmptyEntries))
                    {
                        <li>@line</li>
                    }
                }
                else
                {
                    <li>لا توجد مشاكل مسجلة.</li>
                }
            </ul>

            <p style="padding-top:20px;">التوصيات:</p>
            <ol style="padding-right:50px;padding-top:20px;padding-bottom:15px;">
                @if (!string.IsNullOrWhiteSpace(Model.Recommendations))
                {
                    foreach (var line in Model.Recommendations.Split("\n", StringSplitOptions.RemoveEmptyEntries))
                    {
                        <li>@line</li>
                    }
                }
                else
                {
                    <li>لا توجد توصيات متاحة.</li>
                }
            </ol>

        </div>

        <div class="actions no-print">
            <button onclick="window.print()">طباعة التقرير</button>
            <button id="downloadPdf">تحميل PDF</button>
            <button id="downloadElectronic">تحميل نسخة إلكترونية</button>
        </div>
        <hr />
        <div style="margin:15px">
            <p>تم إجراء التحليل وفقاً للمعايير الدولية المعتمدة - معمل التحاليل الزراعية المتقدمة</p>
            <p>للاستفسارات: info@agri-lab.com | هاتف: 0123456789</p>
        </div>
    </div>

    <script>
        document.getElementById('downloadPdf')?.addEventListener('click', function() {
            alert('سيتم تحميل PDF');
        });

        document.getElementById('downloadElectronic')?.addEventListener('click', function() {
            alert('سيتم تحميل النسخة الإلكترونية');
        });
    </script>
</body>
